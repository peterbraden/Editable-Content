<!doctype html> 
	<head>
		<meta charset="utf-8">  
		<script src="../src/jquery-1.4.2.js"></script>
		<script src="../src/underscore.js"></script>
		
		<script>yam.$ = $</script>
		
		<script src="../src/core.js"></script>
		<script src="../src/dom.js"></script>
		<script src="../src/selection.js"></script>
		<script src="../src/editor.js"></script>
		
		<style>
		body{font-family:helvetica, sans-serif; width:600px; margin:0 auto;}
		#editor{border:1px solid #99f; padding:5px; min-height:200px;}
		.bubble{background-color:#fbb; border-radius:5px;}
		</style>
		
	</head>
	<body>
		<h1>Basic contenteditable sandbox</h1>
	
		<div id = "editor">The <span class='bubble'>quick</span> brown fox jumps over the lazy dog</div>
			
		<pre><code id = 'output'></code></pre>
		
		<script>
			var outlineWithUnderscores = function(e){
				return "_" + e.text() + "_";
			}
		
		
			$(function(){
				var e = new yam.Editor('#editor')

				e.transformText({'.bubble': outlineWithUnderscores})

				e.bind('keyup', function(){ // TODO -bind to 'change event'
					console.log(e.val());
					$("#output").text(e.val());

					// replace text typed with underscores with bubble
					var re = /\_([^\s]*)\_/gi
					  , underscored
					
					while (underscored = re.exec(e.rawText() || '')){
					  e.wrap(underscored.index, underscored.index + underscored[0].length, "<span class='bubble' />")						
					}
					

				})
				

			})
		
		</script>
			
	</body>
</html>	